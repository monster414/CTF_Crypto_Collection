#!/usr/bin/env python3
#coding:utf-8

import gmpy2
from Crypto.Util.number import *

n = 8030860507195481656424331455231443135773524476536419534745106637165762909478292141556846892146553555609301914884176422322286739546193682236355823149096731058044933046552926707682168435727800175783373045726692093694148718521610590523718813096895883533245331244650675812406540694948121258394822022998773233400623162137949381772195351339548977422564546054188918542382088471666795842185019002025083543162991739309935972705871943787733784491735500905013651061284020447578230135075211268405413254368439549259917312445348808412659422810647972872286215701325216318641985498202349281374905892279894612835009186944143298761257 
c = 3304124639719334349997663632110579306673932777705840648575774671427424134287680988314129312593361087606243819528298610131797078262351307396831985397555390640151391138633431951746748156610463582479645561779194981806129898009876517899450840875569675976765155608446799203699927448835004756707151281044859676695533373755798273892503194753948997947653100690841880925445059175494314198605475023939567750409907217654291430615102258523998394231436796902635077995829477347316754739938980814293304289318417443493019704073164585505217658570214989150175123757038125380996050761572021986573934155470641091678664451080065719261207
e = 0x10001

n_mid = gmpy2.iroot(n, 2)[0]
n_part = []
for i in range(1, 2000000):
	n_mid += 1
	if gmpy2.iroot(n_mid**2 - n, 2)[1] == True:
		n_part.append(n_mid)

x1 = n_part[0]
x2 = n_part[1]
y1 = gmpy2.iroot(x1**2 - n, 2)[0]
y2 = gmpy2.iroot(x2**2 - n, 2)[0]
a1 = x1 + y1
b1 = x1 - y1
a2 = x2 + y2
b2 = x2 - y2
p1 = gmpy2.gcd(a1, b2)
p2 = gmpy2.gcd(a2, b1)
q1 = gmpy2.gcd(a1, a2)
q2 = gmpy2.gcd(b1, b2)
phi = (p1 - 1)*(p2 - 1)*(q1 - 1)*(q2 - 1)
d = inverse(e, phi)
m = pow(c, d, n)
flag = long_to_bytes(m)
print(flag)
